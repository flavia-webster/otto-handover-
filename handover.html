<!DOCTYPE html>
<html lang="pt-BR" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Handover Técnico & Validação Arquitetural - Monotto</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { sans: ['Inter', 'sans-serif'] },
                    colors: {
                        brand: { 50: '#f0fdfa', 100: '#ccfbf1', 500: '#14b8a6', 600: '#0d9488', 700: '#0f766e', 900: '#134e4a' },
                        tech: { 800: '#1e293b', 900: '#0f172a' }
                    }
                }
            }
        }
    </script>

    <style>
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f5f9; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        .section-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            border: 1px solid #e2e8f0;
        }
        
        .section-card:hover {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.08), 0 4px 6px -2px rgba(0, 0, 0, 0.04);
            border-color: #cbd5e1;
            transform: translateY(-2px);
        }

        .section-card::before {
            content: '';
            position: absolute;
            top: 0; left: 0; bottom: 0;
            width: 4px;
            background: linear-gradient(to bottom, #0ea5e9, #2563eb);
            opacity: 0.8;
        }

        .section-risk::before { background: linear-gradient(to bottom, #ef4444, #b91c1c); }

        .required-label::after { content: "*"; color: #ef4444; margin-left: 4px; font-weight: bold; }
        .optional-badge { background: #f1f5f9; color: #64748b; font-size: 0.7rem; padding: 2px 6px; border-radius: 4px; margin-left: 8px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; }
        
        .nav-item.active {
            background-color: #eff6ff;
            color: #2563eb;
            border-right: 3px solid #2563eb;
        }

        /* Inputs modernos */
        input:not([type="checkbox"]):not([type="file"]), select, textarea {
            transition: all 0.2s;
            border: 1px solid #e2e8f0;
            background-color: #f8fafc;
        }
        input:not([type="checkbox"]):not([type="file"]):focus, select:focus, textarea:focus {
            background-color: #ffffff;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
            outline: none;
        }

        /* ESTILOS DE IMPRESSÃO (PDF) */
        @media print {
            /* Esconde elementos de navegação e botões */
            .no-print, aside, header button, #submitBtn, .lg\:hidden, #lastSaved, footer {
                display: none !important;
            }

            /* Reseta o layout para folha A4 */
            body { background-color: white; font-size: 11pt; -webkit-print-color-adjust: exact; print-color-adjust: exact; }
            .container { max-width: 100% !important; width: 100% !important; padding: 0 !important; margin: 0 !important; }
            main { width: 100% !important; margin: 0 !important; }
            .section-card { 
                box-shadow: none !important; 
                border: none !important; /* Remove borda do card */
                border-bottom: 2px solid #eee !important; /* Adiciona separador sutil */
                margin-bottom: 10px !important; 
                padding: 10px 0 !important;
                page-break-inside: avoid; 
            }
            /* Remove a barra colorida lateral na impressão */
            .section-card::before { display: none !important; }

            /* Estiliza inputs para parecerem texto fixo de documento */
            input, textarea, select {
                background: transparent !important;
                border: none !important;
                border-bottom: 1px dashed #ccc !important; /* Linha sutil de preenchimento */
                padding: 0 !important; /* Remove padding lateral */
                padding-left: 0 !important;
                margin-top: 5px !important;
                box-shadow: none !important;
                font-weight: 600;
                color: #000;
                width: 100%;
            }
            
            /* Remove ícones na impressão para limpar o visual */
            .fas, .fab, .fa-user, .fa-briefcase, .fa-envelope {
                display: none !important;
            }

            /* Labels mais sóbrias */
            label {
                color: #555 !important;
                font-size: 0.85rem !important;
                text-transform: uppercase;
                letter-spacing: 0.05em;
            }

            /* Ajuste específico para a seção de identificação (remove o pl-10 que dava espaço pro ícone) */
            .pl-10 {
                padding-left: 0 !important;
            }

            textarea { resize: none; overflow: visible; height: auto; }
            
            /* Ajustes no Header */
            header { position: relative !important; padding: 20px 0 !important; background: #1e293b !important; color: white !important; -webkit-print-color-adjust: exact; }
            
            /* Remove backgrounds coloridos para economizar tinta e limpar visual */
            .bg-slate-50, .bg-blue-50, .bg-emerald-50, .bg-red-50, .bg-amber-50 {
                background-color: transparent !important; 
                border: none !important;
                padding-left: 0 !important;
            }
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 antialiased selection:bg-blue-100 selection:text-blue-900">

    <!-- Topbar Decorativa -->
    <div class="h-1 bg-gradient-to-r from-blue-500 via-cyan-500 to-indigo-600 w-full fixed top-0 z-50 no-print"></div>

    <!-- Header -->
    <header class="bg-tech-900 text-white pt-8 pb-12 shadow-xl relative overflow-hidden">
        <!-- Background Pattern -->
        <div class="absolute inset-0 opacity-10" style="background-image: radial-gradient(#64748b 1px, transparent 1px); background-size: 24px 24px;"></div>
        
        <div class="container mx-auto px-6 relative z-10">
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
                <div>
                    <div class="flex items-center gap-3 mb-2">
                        <span class="bg-blue-600/20 text-blue-300 text-xs font-mono px-2 py-1 rounded border border-blue-500/30">MONOTTO TECH</span>
                        <span class="bg-green-600/20 text-green-300 text-xs font-mono px-2 py-1 rounded border border-green-500/30">STATUS: HANDOVER</span>
                    </div>
                    <h1 class="text-3xl md:text-4xl font-bold tracking-tight text-white mb-1">Validação Técnica</h1>
                    <p class="text-slate-400 text-sm md:text-base max-w-xl">Protocolo oficial de transferência de infraestrutura e aplicação.</p>
                </div>
                
                <div class="flex flex-col items-end gap-2 w-full md:w-auto no-print">
                    <div class="bg-slate-800/50 backdrop-blur border border-slate-700 rounded-lg p-3 flex items-center justify-between gap-4 w-full md:w-auto">
                        <span id="lastSaved" class="text-xs text-slate-400 font-mono flex items-center gap-2">
                            <span class="w-2 h-2 rounded-full bg-slate-600" id="statusDot"></span>
                            <span id="statusText">Não salvo</span>
                        </span>
                        <button onclick="saveDraft()" class="text-xs bg-slate-700 hover:bg-slate-600 text-white px-3 py-1.5 rounded transition flex items-center gap-2 border border-slate-600">
                            <i class="fas fa-save"></i> Salvar Rascunho
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <div class="container mx-auto px-4 -mt-8 pb-20 relative z-20">
        <div class="flex flex-col lg:flex-row gap-8">
            
            <!-- Sidebar Navigation (NO-PRINT) -->
            <aside class="lg:w-1/4 hidden lg:block no-print">
                <div class="sticky top-8">
                    <nav class="bg-white rounded-xl shadow-lg border border-slate-200 overflow-hidden">
                        <div class="bg-slate-50 p-4 border-b border-slate-200">
                            <h3 class="font-bold text-slate-700 text-sm uppercase tracking-wider">Índice</h3>
                        </div>
                        <ul class="py-2 text-sm font-medium text-slate-600">
                            <li><a href="#s-intro" class="nav-item flex items-center px-4 py-3 hover:bg-slate-50 transition border-r-4 border-transparent"><i class="fas fa-id-card w-6 text-slate-400"></i> Identificação</a></li>
                            <li><a href="#s-env" class="nav-item flex items-center px-4 py-3 hover:bg-slate-50 transition border-r-4 border-transparent"><i class="fas fa-server w-6 text-slate-400"></i> Ambiente & Node</a></li>
                            <li><a href="#s-aws" class="nav-item flex items-center px-4 py-3 hover:bg-slate-50 transition border-r-4 border-transparent"><i class="fab fa-aws w-6 text-slate-400"></i> Infra AWS</a></li>
                            <li><a href="#s-access" class="nav-item flex items-center px-4 py-3 hover:bg-slate-50 transition border-r-4 border-transparent"><i class="fas fa-key w-6 text-slate-400"></i> Acessos & IAM</a></li>
                            <li><a href="#s-arch" class="nav-item flex items-center px-4 py-3 hover:bg-slate-50 transition border-r-4 border-transparent"><i class="fas fa-sitemap w-6 text-slate-400"></i> Arquitetura</a></li>
                            <li><a href="#s-cost" class="nav-item flex items-center px-4 py-3 hover:bg-slate-50 transition border-r-4 border-transparent"><i class="fas fa-coins w-6 text-slate-400"></i> Custos</a></li>
                            <li><a href="#s-risk" class="nav-item flex items-center px-4 py-3 hover:bg-slate-50 transition border-r-4 border-transparent"><i class="fas fa-shield-alt w-6 text-slate-400"></i> Riscos</a></li>
                        </ul>
                    </nav>

                    <div class="mt-6 bg-white rounded-xl shadow-lg border border-slate-200 p-5">
                        <button onclick="printForm()" id="submitBtn" class="w-full bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white font-bold py-3 px-4 rounded-lg shadow-md hover:shadow-lg transform active:scale-95 transition-all duration-200 flex items-center justify-center group">
                            <span>GERAR PDF OFICIAL</span> 
                            <i class="fas fa-file-pdf ml-2 group-hover:scale-110 transition-transform"></i>
                        </button>
                        <p class="text-[10px] text-center text-slate-400 mt-3 px-2 leading-tight">Ao clicar, a janela de impressão do navegador será aberta. Selecione "Salvar como PDF".</p>
                    </div>
                </div>
            </aside>

            <!-- Mobile Nav Toggle (NO-PRINT) -->
            <div class="lg:hidden mb-4 w-full no-print">
                <div class="bg-white p-4 rounded-lg shadow border border-slate-200">
                    <details>
                        <summary class="font-bold text-slate-700 cursor-pointer flex justify-between items-center">
                            Menu de Navegação <i class="fas fa-chevron-down text-blue-500"></i>
                        </summary>
                        <ul class="mt-4 space-y-2 text-sm">
                            <li><a href="#s-intro" class="block p-2 text-blue-600 bg-blue-50 rounded">Ir para o Formulário</a></li>
                        </ul>
                    </details>
                </div>
            </div>

            <!-- Main Content -->
            <main class="lg:w-3/4 space-y-8" id="mainForm">
                <!-- Wrapper for FORM -->
                <form id="handoverForm" onsubmit="return false;">
                    
                    <!-- Section 1: Identificação -->
                    <section id="s-intro" class="section-card p-6 md:p-8">
                        <div class="flex items-center gap-3 mb-6 pb-4 border-b border-slate-100">
                            <div class="bg-blue-100 text-blue-600 p-2 rounded-lg"><i class="fas fa-user-circle text-xl"></i></div>
                            <h2 class="text-xl font-bold text-slate-800">Identificação do Responsável</h2>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="group">
                                <label class="block text-sm font-semibold text-slate-600 mb-2 required-label">Nome Completo</label>
                                <div class="relative">
                                    <i class="fas fa-user absolute left-3 top-3.5 text-slate-400"></i>
                                    <input type="text" name="Responsável" class="w-full pl-10 p-3 rounded-lg border-slate-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-200" placeholder="Seu nome" required>
                                </div>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-slate-600 mb-2 required-label">Cargo / Função Técnica</label>
                                <div class="relative">
                                    <i class="fas fa-briefcase absolute left-3 top-3.5 text-slate-400"></i>
                                    <input type="text" name="Cargo" class="w-full pl-10 p-3 rounded-lg border-slate-200" placeholder="Ex: Tech Lead" required>
                                </div>
                            </div>
                            <div class="md:col-span-2">
                                <label class="block text-sm font-semibold text-slate-600 mb-2 required-label">Email Corporativo</label>
                                <div class="relative">
                                    <i class="fas fa-envelope absolute left-3 top-3.5 text-slate-400"></i>
                                    <input type="email" name="Email_Responsavel" class="w-full pl-10 p-3 rounded-lg border-slate-200" placeholder="email@empresa.com" required>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Section 2: Ambiente -->
                    <section id="s-env" class="section-card p-6 md:p-8 mt-8">
                        <div class="flex items-center gap-3 mb-6 pb-4 border-b border-slate-100">
                            <div class="bg-indigo-100 text-indigo-600 p-2 rounded-lg"><i class="fas fa-code-branch text-xl"></i></div>
                            <h2 class="text-xl font-bold text-slate-800">Ambiente e Versionamento</h2>
                        </div>

                        <div class="bg-amber-50 border border-amber-200 rounded-lg p-4 mb-8 flex gap-4 items-start shadow-sm">
                            <i class="fas fa-exclamation-triangle text-amber-500 text-xl mt-1"></i>
                            <div>
                                <h4 class="font-bold text-amber-800 text-sm uppercase">Requisito Bloqueante: Node 20</h4>
                                <p class="text-sm text-amber-700 mt-1">Identificamos o uso de Node 16 no <code>package.json</code>. A migração para Node 20 é mandatória para aceitação deste projeto.</p>
                            </div>
                        </div>

                        <div class="space-y-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label class="block text-sm font-semibold text-slate-600 mb-2 required-label">Versão Node.js (Produção)</label>
                                    <input type="text" name="Versao_Node" placeholder="Ex: 16.17.1" class="w-full p-3 rounded-lg border-slate-200 font-mono text-sm" required>
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-slate-600 mb-2 required-label">Confirma ciência da migração?</label>
                                    <div class="relative">
                                        <select name="Ciencia_Migracao" class="w-full p-3 rounded-lg border-slate-200 appearance-none bg-white font-medium text-slate-700" required>
                                            <option value="">Selecione uma opção...</option>
                                            <option value="Sim">Sim, estamos cientes e mapeamos os impactos</option>
                                            <option value="Nao">Não (Justificar detalhadamente abaixo)</option>
                                        </select>
                                        <i class="fas fa-chevron-down absolute right-3 top-4 text-slate-400 pointer-events-none"></i>
                                    </div>
                                </div>
                            </div>

                            <div>
                                <label class="block text-sm font-semibold text-slate-600 mb-2 required-label">Pacotes/Libs Incompatíveis</label>
                                <p class="text-xs text-slate-400 mb-2">Liste bibliotecas que quebrarão na atualização (Ex: `node-sass`, AWS SDK v2, TypeORM versões antigas).</p>
                                <textarea name="Libs_Incompativeis" rows="3" class="w-full p-3 rounded-lg border-slate-200 font-mono text-sm" placeholder="- Lib X (v1.0)&#10;- Lib Y..." required></textarea>
                            </div>

                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label class="block text-sm font-semibold text-slate-600 mb-2 required-label">Pipeline de Build</label>
                                    <p class="text-xs text-slate-400 mb-2">Descreva a ordem EXATA de execução.</p>
                                    <textarea name="Pipeline_Build" rows="5" class="w-full p-3 rounded-lg border-slate-200 font-mono text-xs bg-slate-50" placeholder="1. yarn install&#10;2. yarn build:back&#10;3. serverless deploy..." required></textarea>
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-slate-600 mb-2 required-label">Variáveis de Ambiente (.env)</label>
                                    <p class="text-xs text-slate-400 mb-2">Apenas CHAVES (Keys), sem valores.</p>
                                    <textarea name="Variaveis_Env" rows="5" class="w-full p-3 rounded-lg border-slate-200 font-mono text-xs bg-slate-50" placeholder="DB_HOST&#10;AWS_ACCESS_KEY_ID&#10;FIREBASE_CONFIG..." required></textarea>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Section 3: AWS -->
                    <section id="s-aws" class="section-card p-6 md:p-8 mt-8">
                        <div class="flex items-center gap-3 mb-6 pb-4 border-b border-slate-100">
                            <div class="bg-orange-100 text-orange-600 p-2 rounded-lg"><i class="fab fa-aws text-xl"></i></div>
                            <h2 class="text-xl font-bold text-slate-800">Infraestrutura AWS</h2>
                        </div>

                        <p class="text-sm text-slate-500 mb-6 bg-blue-50 p-3 rounded border border-blue-100"><i class="fas fa-info-circle mr-1"></i> Selecione os serviços ativos e detalhe as configurações.</p>

                        <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3 mb-8">
                            <!-- Checkboxes AWS (Mantidos) -->
                            <label class="cursor-pointer relative group">
                                <input type="checkbox" name="Servicos_AWS" value="Lambda" class="peer sr-only">
                                <div class="p-3 rounded-lg border border-slate-200 bg-white text-slate-600 text-sm font-medium transition-all peer-checked:border-blue-500 peer-checked:bg-blue-50 peer-checked:text-blue-700 hover:border-blue-300 flex items-center justify-between">
                                    <span>Lambda</span>
                                    <i class="fas fa-check opacity-0 peer-checked:opacity-100 text-blue-500"></i>
                                </div>
                            </label>
                            <label class="cursor-pointer relative group">
                                <input type="checkbox" name="Servicos_AWS" value="API Gateway" class="peer sr-only">
                                <div class="p-3 rounded-lg border border-slate-200 bg-white text-slate-600 text-sm font-medium transition-all peer-checked:border-blue-500 peer-checked:bg-blue-50 peer-checked:text-blue-700 hover:border-blue-300 flex items-center justify-between">
                                    <span>API Gateway</span>
                                    <i class="fas fa-check opacity-0 peer-checked:opacity-100 text-blue-500"></i>
                                </div>
                            </label>
                            <label class="cursor-pointer relative group">
                                <input type="checkbox" name="Servicos_AWS" value="S3" class="peer sr-only">
                                <div class="p-3 rounded-lg border border-slate-200 bg-white text-slate-600 text-sm font-medium transition-all peer-checked:border-blue-500 peer-checked:bg-blue-50 peer-checked:text-blue-700 hover:border-blue-300 flex items-center justify-between">
                                    <span>S3</span>
                                    <i class="fas fa-check opacity-0 peer-checked:opacity-100 text-blue-500"></i>
                                </div>
                            </label>
                            <label class="cursor-pointer relative group">
                                <input type="checkbox" name="Servicos_AWS" value="RDS" class="peer sr-only">
                                <div class="p-3 rounded-lg border border-slate-200 bg-white text-slate-600 text-sm font-medium transition-all peer-checked:border-blue-500 peer-checked:bg-blue-50 peer-checked:text-blue-700 hover:border-blue-300 flex items-center justify-between">
                                    <span>RDS</span>
                                    <i class="fas fa-check opacity-0 peer-checked:opacity-100 text-blue-500"></i>
                                </div>
                            </label>
                            <label class="cursor-pointer relative group">
                                <input type="checkbox" name="Servicos_AWS" value="DynamoDB" class="peer sr-only">
                                <div class="p-3 rounded-lg border border-slate-200 bg-white text-slate-600 text-sm font-medium transition-all peer-checked:border-blue-500 peer-checked:bg-blue-50 peer-checked:text-blue-700 hover:border-blue-300 flex items-center justify-between">
                                    <span>DynamoDB</span>
                                    <i class="fas fa-check opacity-0 peer-checked:opacity-100 text-blue-500"></i>
                                </div>
                            </label>
                            <label class="cursor-pointer relative group">
                                <input type="checkbox" name="Servicos_AWS" value="SQS" class="peer sr-only">
                                <div class="p-3 rounded-lg border border-slate-200 bg-white text-slate-600 text-sm font-medium transition-all peer-checked:border-blue-500 peer-checked:bg-blue-50 peer-checked:text-blue-700 hover:border-blue-300 flex items-center justify-between">
                                    <span>SQS</span>
                                    <i class="fas fa-check opacity-0 peer-checked:opacity-100 text-blue-500"></i>
                                </div>
                            </label>
                            <label class="cursor-pointer relative group">
                                <input type="checkbox" name="Servicos_AWS" value="SNS" class="peer sr-only">
                                <div class="p-3 rounded-lg border border-slate-200 bg-white text-slate-600 text-sm font-medium transition-all peer-checked:border-blue-500 peer-checked:bg-blue-50 peer-checked:text-blue-700 hover:border-blue-300 flex items-center justify-between">
                                    <span>SNS</span>
                                    <i class="fas fa-check opacity-0 peer-checked:opacity-100 text-blue-500"></i>
                                </div>
                            </label>
                            <label class="cursor-pointer relative group">
                                <input type="checkbox" name="Servicos_AWS" value="CloudFront" class="peer sr-only">
                                <div class="p-3 rounded-lg border border-slate-200 bg-white text-slate-600 text-sm font-medium transition-all peer-checked:border-blue-500 peer-checked:bg-blue-50 peer-checked:text-blue-700 hover:border-blue-300 flex items-center justify-between">
                                    <span>CloudFront</span>
                                    <i class="fas fa-check opacity-0 peer-checked:opacity-100 text-blue-500"></i>
                                </div>
                            </label>
                            <label class="cursor-pointer relative group">
                                <input type="checkbox" name="Servicos_AWS" value="Secrets Manager" class="peer sr-only">
                                <div class="p-3 rounded-lg border border-slate-200 bg-white text-slate-600 text-sm font-medium transition-all peer-checked:border-blue-500 peer-checked:bg-blue-50 peer-checked:text-blue-700 hover:border-blue-300 flex items-center justify-between">
                                    <span>Secrets Mgr</span>
                                    <i class="fas fa-check opacity-0 peer-checked:opacity-100 text-blue-500"></i>
                                </div>
                            </label>
                            <label class="cursor-pointer relative group">
                                <input type="checkbox" name="Servicos_AWS" value="VPC" class="peer sr-only">
                                <div class="p-3 rounded-lg border border-slate-200 bg-white text-slate-600 text-sm font-medium transition-all peer-checked:border-blue-500 peer-checked:bg-blue-50 peer-checked:text-blue-700 hover:border-blue-300 flex items-center justify-between">
                                    <span>VPC</span>
                                    <i class="fas fa-check opacity-0 peer-checked:opacity-100 text-blue-500"></i>
                                </div>
                            </label>
                        </div>

                        <div id="awsDetailsContainer" class="space-y-4">
                            <div class="text-center py-8 border-2 border-dashed border-slate-200 rounded-lg text-slate-400 bg-slate-50/50">
                                <i class="fas fa-cubes text-3xl mb-2 opacity-50"></i>
                                <p class="text-sm">Selecione serviços acima para abrir os campos de detalhamento.</p>
                            </div>
                        </div>
                    </section>

                    <!-- Section 4: Acessos -->
                    <section id="s-access" class="section-card p-6 md:p-8 mt-8">
                        <div class="flex items-center gap-3 mb-6 pb-4 border-b border-slate-100">
                            <div class="bg-purple-100 text-purple-600 p-2 rounded-lg"><i class="fas fa-fingerprint text-xl"></i></div>
                            <h2 class="text-xl font-bold text-slate-800">Acessos e Permissões</h2>
                        </div>
                        <div class="space-y-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label class="block text-sm font-semibold text-slate-600 mb-2 required-label">ID da Conta AWS (Produção)</label>
                                    <input type="text" name="AWS_Account_ID" class="w-full p-3 rounded-lg border-slate-200 font-mono" placeholder="123456789012" required>
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-slate-600 mb-2 required-label">Região Principal</label>
                                    <input type="text" name="AWS_Region" value="us-east-1" class="w-full p-3 rounded-lg border-slate-200 font-mono" required>
                                </div>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-slate-600 mb-2 required-label">Políticas IAM Específicas</label>
                                <p class="text-xs text-slate-400 mb-2">Permissões granulares necessárias (evite 'AdministratorAccess').</p>
                                <textarea name="IAM_Policies" rows="3" class="w-full p-3 rounded-lg border-slate-200 font-mono text-xs" placeholder="iam:PassRole, s3:PutObject em buckets específicos..." required></textarea>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-slate-600 mb-2 required-label">Restrições de Rede/VPN</label>
                                <p class="text-xs text-slate-400 mb-2">Liste Security Groups críticos ou acessos restritos a IP/VPN.</p>
                                <input type="text" name="Restricoes_Rede" class="w-full p-3 rounded-lg border-slate-200" placeholder="Ex: RDS acessível apenas via Bastion Host 10.0.0.5" required>
                            </div>
                        </div>
                    </section>

                    <!-- Section 5: Arquitetura -->
                    <section id="s-arch" class="section-card p-6 md:p-8 mt-8">
                        <div class="flex items-center gap-3 mb-6 pb-4 border-b border-slate-100">
                            <div class="bg-teal-100 text-teal-600 p-2 rounded-lg"><i class="fas fa-project-diagram text-xl"></i></div>
                            <h2 class="text-xl font-bold text-slate-800">Arquitetura</h2>
                        </div>
                        
                        <!-- Upload Removido. Substituído por input de texto simples para link -->
                        <div class="bg-slate-50 p-6 rounded-xl border border-slate-200">
                            <label class="block text-sm font-bold text-slate-700 mb-2 required-label">Link do Diagrama (Miro/Drive/Confluence)</label>
                            <p class="text-xs text-slate-500 mb-3">Cole aqui o link público ou interno para o diagrama de arquitetura atualizado.</p>
                            <input type="text" name="Link_Diagrama" class="w-full p-3 rounded-lg border-slate-200 text-blue-600 font-medium" placeholder="https://miro.com/app/board/..." required>
                        </div>
                    </section>

                     <!-- Section 6: Custos -->
                     <section id="s-cost" class="section-card p-6 md:p-8 mt-8">
                        <div class="flex items-center gap-3 mb-6 pb-4 border-b border-slate-100">
                            <div class="bg-emerald-100 text-emerald-600 p-2 rounded-lg"><i class="fas fa-money-bill-wave text-xl"></i></div>
                            <h2 class="text-xl font-bold text-slate-800">Custos e Consumo</h2>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                            <div class="bg-emerald-50/50 p-4 rounded-lg border border-emerald-100">
                                <label class="block text-xs font-bold text-emerald-800 mb-2 uppercase tracking-wide required-label">Média Mensal (USD)</label>
                                <div class="relative">
                                    <span class="absolute left-3 top-2.5 text-emerald-600 font-bold">$</span>
                                    <input type="number" name="Custo_Medio_USD" class="w-full pl-6 p-2 rounded border-emerald-200 focus:border-emerald-500 focus:ring-emerald-200 bg-white" placeholder="0.00" required>
                                </div>
                            </div>
                            <div class="md:col-span-2">
                                <label class="block text-sm font-semibold text-slate-600 mb-2 required-label">Maior Ofensor de Custo</label>
                                <input type="text" name="Maior_Ofensor_Custo" class="w-full p-3 rounded-lg border-slate-200" placeholder="Ex: RDS Multi-AZ (Produção)" required>
                            </div>
                        </div>
                        <!-- Otimização (Opcional) -->
                        <div>
                            <label class="block text-sm font-semibold text-slate-600 mb-2">Oportunidade de Savings <span class="optional-badge">Opcional</span></label>
                            <p class="text-xs text-slate-400 mb-2">Identificou recursos ociosos ou superdimensionados?</p>
                            <textarea name="Oportunidade_Savings" rows="2" class="w-full p-3 rounded-lg border-slate-200 bg-slate-50" placeholder="Ex: Ambientes de Dev ligados 24/7..."></textarea>
                        </div>
                    </section>

                     <!-- Section 7: Riscos -->
                     <section id="s-risk" class="section-card section-risk p-6 md:p-8 border-l-4 border-l-red-500 mt-8">
                        <div class="flex items-center gap-3 mb-6 pb-4 border-b border-slate-100">
                            <div class="bg-red-100 text-red-600 p-2 rounded-lg"><i class="fas fa-biohazard text-xl"></i></div>
                            <h2 class="text-xl font-bold text-slate-800">Riscos Técnicos</h2>
                        </div>
                        <div class="space-y-6">
                            <div>
                                <label class="block text-sm font-bold text-red-800 mb-2 required-label">Pendências Críticas (Showstoppers)</label>
                                <p class="text-xs text-red-400 mb-2">O que impede o deploy ou a operação segura HOJE?</p>
                                <textarea name="Riscos_Criticos" rows="3" class="w-full p-3 rounded-lg border-red-200 bg-red-50 focus:border-red-400 focus:ring-red-100" placeholder="Ex: Certificados SSL expirando, Backups falhando..." required></textarea>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label class="block text-sm font-semibold text-slate-600 mb-2 required-label">Limitações Arquiteturais</label>
                                    <textarea name="Limitacoes_Arquitetura" rows="3" class="w-full p-3 rounded-lg border-slate-200" placeholder="Ex: Cold starts altos, query lento no Postgres..." required></textarea>
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-slate-600 mb-2">Débitos Técnicos <span class="optional-badge">Opcional</span></label>
                                    <textarea name="Debitos_Tecnicos" rows="3" class="w-full p-3 rounded-lg border-slate-200 bg-slate-50" placeholder="Ex: Refatoração necessária no módulo de Auth..."></textarea>
                                </div>
                            </div>
                        </div>
                    </section>
                </form>

                <!-- Footer do Form Mobile -->
                <div class="lg:hidden mt-8 space-y-4 no-print">
                    <button onclick="printForm()" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 rounded-lg shadow-lg">GERAR PDF</button>
                </div>

            </main>
        </div>
    </div>

    <!-- Rodapé -->
    <footer class="bg-slate-900 text-slate-400 py-12 border-t border-slate-800 mt-auto no-print">
        <div class="container mx-auto px-4 text-center">
            <p class="text-sm font-medium mb-2">VALIDAÇÃO DE INFRAESTRUTURA & HANDOVER</p>
            <p class="text-xs text-slate-600">Este documento é confidencial e de uso exclusivo da equipe de engenharia.</p>
        </div>
    </footer>

    <!-- Logic Script -->
    <script>
        // --- UI Interactions ---
        
        // AWS Dynamic Fields
        const awsCheckboxes = document.querySelectorAll('input[name="Servicos_AWS"]');
        const awsContainer = document.getElementById('awsDetailsContainer');

        awsCheckboxes.forEach(cb => {
            cb.addEventListener('change', updateAwsDetails);
        });

        function updateAwsDetails() {
            const selected = Array.from(document.querySelectorAll('input[name="Servicos_AWS"]:checked')).map(cb => cb.value);
            
            // Se vazio
            if (selected.length === 0) {
                awsContainer.innerHTML = `
                    <div class="text-center py-8 border-2 border-dashed border-slate-200 rounded-lg text-slate-400 bg-slate-50/50">
                        <i class="fas fa-cubes text-3xl mb-2 opacity-50"></i>
                        <p class="text-sm">Selecione serviços acima para configurar detalhes.</p>
                    </div>`;
                return;
            }

            // Remove box de 'vazio' se existir
            if (awsContainer.querySelector('.text-center')) {
                awsContainer.innerHTML = '';
            }

            // Adiciona novos inputs dinamicamente
            selected.forEach(service => {
                // Remove espaços para criar IDs seguros
                const safeName = service.replace(/\s/g, '');
                const id = `aws_detail_${safeName}`;
                
                if (!document.getElementById(id)) {
                    let configPlaceholder = "Ex: 512MB RAM, Timeout 30s";
                    if(service.includes("RDS")) configPlaceholder = "Ex: db.t3.medium, Multi-AZ";
                    if(service.includes("S3")) configPlaceholder = "Ex: Public Access Block, Versioning";
                    
                    // Prefixamos os names dinâmicos com "Detalhe_AWS_"
                    const html = `
                        <div id="${id}" class="bg-white p-4 rounded-lg border border-slate-200 shadow-sm animate-fade-in border-l-4 border-l-blue-400 mb-4">
                            <div class="flex justify-between items-center mb-3">
                                <h4 class="font-bold text-slate-700 flex items-center gap-2">
                                    <i class="fab fa-aws text-orange-500"></i> ${service}
                                </h4>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="text-xs font-bold text-slate-500 uppercase required-label">Finalidade</label>
                                    <input type="text" name="Detalhe_AWS_${safeName}_Finalidade" placeholder="Para que serve este recurso?" class="w-full mt-1 p-2 rounded border border-slate-200 text-sm focus:border-blue-400 focus:ring-1 focus:ring-blue-200" required>
                                </div>
                                <div>
                                    <label class="text-xs font-bold text-slate-500 uppercase required-label">Configuração Crítica</label>
                                    <input type="text" name="Detalhe_AWS_${safeName}_Config" placeholder="${configPlaceholder}" class="w-full mt-1 p-2 rounded border border-slate-200 text-sm focus:border-blue-400 focus:ring-1 focus:ring-blue-200" required>
                                </div>
                            </div>
                        </div>
                    `;
                    awsContainer.insertAdjacentHTML('beforeend', html);
                }
            });

            // Remove desmarcados
            Array.from(awsContainer.children).forEach(div => {
                if (div.querySelector('h4')) {
                    const serviceName = div.querySelector('h4').innerText.trim();
                    if (!selected.includes(serviceName)) {
                        div.remove();
                    }
                }
            });
        }

        // Save & Load Draft Logic (LocalStorage)
        function saveDraft() {
            const formData = {};
            // Ignoramos input file no localStorage
            const elements = document.querySelectorAll('input:not([type="file"]), textarea, select');
            elements.forEach(el => {
                if (el.name) {
                    if (el.type === 'checkbox') {
                        if (!formData[el.name]) formData[el.name] = [];
                        if (el.checked) formData[el.name].push(el.value);
                    } else {
                        formData[el.name] = el.value;
                    }
                }
            });
            
            localStorage.setItem('monotto_handover_draft_v2', JSON.stringify(formData));
            
            const now = new Date();
            const timeStr = `${now.getHours()}:${now.getMinutes().toString().padStart(2, '0')}`;
            
            const dot = document.getElementById('statusDot');
            const text = document.getElementById('statusText');
            
            if (dot) {
                dot.classList.remove('bg-slate-600');
                dot.classList.add('bg-green-500');
            }
            if (text) {
                text.innerText = `Salvo às ${timeStr}`;
            }
            
            // Feedback no botão
            const btn = document.querySelector('button[onclick="saveDraft()"]');
            if (btn) {
                const originalText = btn.innerHTML;
                btn.innerHTML = `<i class="fas fa-check"></i> Salvo!`;
                setTimeout(() => { btn.innerHTML = originalText; }, 2000);
            }
        }

        function loadDraft() {
            const draft = localStorage.getItem('monotto_handover_draft_v2');
            if (draft) {
                try {
                    const data = JSON.parse(draft);
                    
                    for (const key in data) {
                        // Cuidando de checkboxes (Servicos_AWS)
                        if (Array.isArray(data[key])) {
                             data[key].forEach(val => {
                                const cb = document.querySelector(`input[name="${key}"][value="${val}"]`);
                                if (cb) cb.checked = true;
                            });
                            // Se for AWS, atualiza a UI
                            if (key === 'Servicos_AWS') updateAwsDetails();
                        } else {
                            // Campos normais
                            const el = document.querySelector(`[name="${key}"]`);
                            if (el && el.type !== 'file' && el.type !== 'checkbox') {
                                el.value = data[key];
                            }
                        }
                    }
                    
                    // Restaurar inputs dinâmicos da AWS
                    setTimeout(() => {
                        for (const key in data) {
                            if (key.startsWith('Detalhe_AWS_')) {
                                const dynamicEl = document.querySelector(`[name="${key}"]`);
                                if (dynamicEl) dynamicEl.value = data[key];
                            }
                        }
                    }, 100);

                } catch(e) { console.error("Erro ao carregar rascunho", e); }
            }
        }

        // PRINT LOGIC (Substitui envio por email)
        function printForm() {
            const form = document.getElementById('handoverForm');
            
            // 1. Validação
            const requiredInputs = form.querySelectorAll('[required]');
            let valid = true;
            let firstInvalid = null;

            requiredInputs.forEach(el => {
                if (!el.value || (el.type === 'checkbox' && !el.checked)) {
                    el.classList.add('border-red-500', 'ring-1', 'ring-red-500');
                    valid = false;
                    if(!firstInvalid) firstInvalid = el;
                } else {
                    el.classList.remove('border-red-500', 'ring-1', 'ring-red-500');
                }
            });

            if (!valid) {
                alert("Existem campos OBRIGATÓRIOS não preenchidos. Verifique os itens em vermelho.");
                if (firstInvalid) firstInvalid.scrollIntoView({ behavior: 'smooth', block: 'center' });
                return;
            }

            // 2. Salva rascunho para garantir
            saveDraft();

            // 3. Aciona a impressão nativa
            window.print();
        }

        // Init
        window.addEventListener('load', loadDraft);
    </script>
</body>
</html>